<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Covershot: Home</title>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/covershot.css">
    <script src="scripts/jquery-1.7.1.min.js"></script>
    <script src="scripts/jquery.tablesort.js"></script>
    <script src="scripts/simplemeter.js"></script>
  </head>
  <body>
    <div id="bodyWrapper">
      <header>
        <ul class="summary">
          <li>
            <h1><%= files.length %></h1>
            <h3>Files</h3>
          </li>
          <li>
            <h1><%= hits %></h1>
            <h3>Hits</h3>
          </li>
          <li>
            <h1><%= misses %></h1>
            <h3>Misses</h3>
          </li>
          <li>
            <h1><%= sloc %></h1>
            <h3>SLoC</h3>
          </li>
          <li>
            <h1><%= coverage.toFixed(2) %>%</h1>
            <h3>Coverage</h3>
          </li>
        </ul>
      </header>
      <section id="bod">
        <section id="mainContent">
          <table id="files">
            <thead>
              <tr>
                <th>Files</th>
                <th class="number">Hits</th>
                <th class="number">Misses</th>
                <th class="number">SLoC</th>
                <th>Coverage</th>
              </tr>
            </thead>
            <tbody>
              <% for (var file=0; file<files.length; file++) { %>
              <tr>
                <td>
                  <a href="src/<%= files[file].filename %>.html"><%= files[file].filename %></a>
                </td>
                <td>
                  <p><%= files[file].hits %></p>
                </td>
                <td>
                  <p><%= files[file].misses %></p>
                </td>
                <td>
                  <p><%= files[file].sloc %></p>
                </td>
                <td data-sort-value="<%= files[file].coverage.toFixed(2) %>">
                </td>
              </tr>
              <% } %>
            </tbody>
          </table>
        </section>
      </section>
    </div>
    <footer>
      <p>Report generated by <a>Covershot</a> on <%= generated %>.</p>
    </footer>
    <script type="text/javascript">
      $(document).ready(function () {
        $('thead th.number').data('sortBy', function(th, td, tablesort) {
          return parseInt(td.text(), 10);
        });
        $('table').tablesort();

        var filesTablesort = $('#files').data('tablesort');
        filesTablesort.sort($('#files th:nth-child(3)'), 'desc');

        $('#files tbody tr td:last-child').each(function (index, element) {
          var container = $(element).get(0);
          var percentage = parseFloat($(container).data('sortValue')).toFixed(2);
          var sm = new SimpleMeter(container);
          sm.add(percentage);
        });
      });
    </script>
  </body>
</html>
