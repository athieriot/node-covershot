<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Covershot: Home</title>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/covershot.css">
    <script src="scripts/jquery-1.7.1.min.js"></script>
    <script src="scripts/jquery.tablesort.js"></script>
    <script src="scripts/simplemeter.js"></script>
  </head>
  <body>
    <div id="bodyWrapper">
      <header>
        <h1>Covershot - Summary</h1>

          <div class="columnize">
            <ul class="summary">
              <li>
                <h3><span class="coverageData"><%= files.length %></span> files</h3>
              </li>
              <li>
                <h3><span class="coverageData"><%= hits %></span> hits</h3>
              </li>
              <li>
                <h3><span class="coverageData"><%= misses %></span> misses</h3>
              </li>
              <li>
                <h3><span class="coverageData"><%= sloc %></span> SLoC</h3>
              </li>
              <li>
                <h3><span class="coverageData"><%= coverage.toFixed(1) %>%</span> coverage</h3>
              </li>
            </ul>
            <aside id="hotspotsLinkContainer">
              <h3><a href="hotspots.html">Hotspots</a></h3>        
            </aside>
          </div>

      </header>
      <section id="bod">
        <section id="mainContent">
          <table id="files">
            <thead>
              <tr>
                <th>Files</th>
                <th class="number">Hits</th>
                <th class="number">Misses</th>
                <th class="number">SLoC</th>
                <% if(hasJsMeterData) { %>
                  <th class="number"><span title="Maintainability Index">MI</span></th>
                <% } %>
                <th>Coverage</th>
              </tr>
            </thead>
            <tbody>
              <% for (var file=0; file<files.length; file++) { %>
              <tr>
                <td>
                  <a href="src/<%= files[file].filename %>.html"><%= files[file].filename %></a>
                </td>
                <td>
                  <p><%= files[file].hits %></p>
                </td>
                <td>
                  <p><%= files[file].misses %></p>
                </td>
                <td>
                  <p><%= files[file].sloc %></p>
                </td>
                <% if(hasJsMeterData) { %>
                  <td>
                    <p><%= files[file].jsmeter ? files[file].jsmeter.mi : '?' %></p>
                  </td>
                <% } %>
                <td data-sort-value="<%= files[file].coverage.toFixed(0) %>">
                </td>
              </tr>
              <% } %>
            </tbody>
          </table>
        </section>
      </section>
    </div>
    <footer>
      <p>Report generated by <a href="https://github.com/nearinfinity/node-covershot">Covershot</a> on <%= generated %>.</p>
    </footer>
    <script type="text/javascript">
      $(document).ready(function () {
        $('thead th.number').data('sortBy', function(th, td, tablesort) {
          return parseInt(td.text(), 10);
        });
        $('table').tablesort({
          initSort: {
            index: 2,
            direction: 'desc'
          }
        });

        $('#files tbody tr td:last-child').each(function (index, element) {
          var container = $(element).get(0);
          var percentage = parseFloat($(container).data('sortValue'));
          var sm = new SimpleMeter(container);
          sm.add(percentage);
        });
      });
    </script>
  </body>
</html>
